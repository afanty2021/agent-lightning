{
  "scan_timestamp": "2025-11-20T09:36:09Z",
  "project_info": {
    "name": "agent-lightning",
    "version": "0.2.2",
    "description": "Agent-lightning is the absolute trainer to light up AI agents.",
    "language": "Python",
    "package_manager": "uv"
  },
  "scan_coverage": {
    "total_files_scanned": 127,
    "total_python_files": 98,
    "total_modules_identified": 13,
    "total_examples_identified": 7,
    "coverage_percentage": 98.4,
    "truncated": false,
    "previous_coverage": 85.2,
    "improvement": "+13.2%"
  },
  "modules": [
    {
      "path": "agentlightning/adapter",
      "name": "adapter",
      "type": "core_module",
      "description": "适配器层，处理不同框架和协议的数据转换",
      "entry_files": ["__init__.py", "base.py", "messages.py", "triplet.py"],
      "has_tests": true,
      "has_config": false,
      "coverage": "high",
      "documentation": "complete"
    },
    {
      "path": "agentlightning/algorithm",
      "name": "algorithm",
      "type": "core_module",
      "description": "算法实现，包含训练和优化算法",
      "entry_files": ["__init__.py", "base.py", "decorator.py", "fast.py"],
      "submodules": ["apo", "verl"],
      "has_tests": true,
      "has_config": false,
      "coverage": "high",
      "documentation": "complete"
    },
    {
      "path": "agentlightning/algorithm/apo",
      "name": "apo",
      "type": "algorithm_submodule",
      "description": "自动提示优化算法，使用文本梯度和束搜索",
      "entry_files": ["__init__.py", "apo.py"],
      "prompt_templates": ["text_gradient_variant01.poml", "text_gradient_variant02.poml", "text_gradient_variant03.poml", "apply_edit_variant01.poml", "apply_edit_variant02.poml"],
      "has_tests": true,
      "has_config": false,
      "coverage": "high",
      "documentation": "complete"
    },
    {
      "path": "agentlightning/cli",
      "name": "cli",
      "type": "interface_module",
      "description": "命令行工具，提供各种管理接口",
      "entry_files": ["__init__.py", "store.py", "vllm.py"],
      "has_tests": true,
      "has_config": false,
      "coverage": "medium",
      "documentation": "partial"
    },
    {
      "path": "agentlightning/emitter",
      "name": "emitter",
      "type": "core_module",
      "description": "事件发射器，处理追踪和奖励事件",
      "entry_files": ["__init__.py", "exception.py", "message.py", "object.py", "reward.py", "utils.py"],
      "has_tests": true,
      "has_config": false,
      "coverage": "high",
      "documentation": "complete"
    },
    {
      "path": "agentlightning/execution",
      "name": "execution",
      "type": "runtime_module",
      "description": "执行策略，管理进程和资源分配",
      "entry_files": ["__init__.py", "base.py", "client_server.py", "events.py", "inter_process.py", "shared_memory.py"],
      "has_tests": true,
      "has_config": false,
      "coverage": "high",
      "documentation": "complete"
    },
    {
      "path": "agentlightning/instrumentation",
      "name": "instrumentation",
      "type": "integration_module",
      "description": "集成工具，支持第三方监控工具",
      "entry_files": ["__init__.py", "agentops.py", "agentops_langchain.py", "litellm.py", "vllm.py"],
      "has_tests": true,
      "has_config": false,
      "coverage": "medium",
      "documentation": "partial"
    },
    {
      "path": "agentlightning/litagent",
      "name": "litagent",
      "type": "interface_module",
      "description": "轻量级智能体基类，定义智能体接口",
      "entry_files": ["__init__.py", "decorator.py", "litagent.py"],
      "has_tests": true,
      "has_config": false,
      "coverage": "high",
      "documentation": "complete"
    },
    {
      "path": "agentlightning/runner",
      "name": "runner",
      "type": "runtime_module",
      "description": "运行器，负责执行智能体任务",
      "entry_files": ["__init__.py", "agent.py", "base.py", "legacy.py"],
      "has_tests": true,
      "has_config": false,
      "coverage": "high",
      "documentation": "complete"
    },
    {
      "path": "agentlightning/store",
      "name": "store",
      "type": "data_module",
      "description": "存储层，管理任务、资源和追踪数据",
      "entry_files": ["__init__.py", "base.py", "client_server.py", "memory.py", "sqlite.py", "threading.py", "utils.py"],
      "has_tests": true,
      "has_config": false,
      "coverage": "high",
      "documentation": "complete"
    },
    {
      "path": "agentlightning/tracer",
      "name": "tracer",
      "type": "observability_module",
      "description": "追踪器，记录执行轨迹和性能指标",
      "entry_files": ["__init__.py", "agentops.py", "base.py", "http.py", "otel.py"],
      "has_tests": true,
      "has_config": false,
      "coverage": "high",
      "documentation": "complete"
    },
    {
      "path": "agentlightning/trainer",
      "name": "trainer",
      "type": "orchestration_module",
      "description": "训练器，协调算法、运行器和存储",
      "entry_files": ["__init__.py", "init_utils.py", "legacy.py", "registry.py", "trainer.py"],
      "has_tests": true,
      "has_config": false,
      "coverage": "high",
      "documentation": "complete"
    },
    {
      "path": "agentlightning/types",
      "name": "types",
      "type": "core_module",
      "description": "类型定义，核心数据模型和协议",
      "entry_files": ["__init__.py", "core.py", "resources.py", "tracer.py"],
      "has_tests": true,
      "has_config": false,
      "coverage": "high",
      "documentation": "complete"
    },
    {
      "path": "agentlightning/verl",
      "name": "verl",
      "type": "algorithm_module",
      "description": "VERL 集成，支持大规模强化学习",
      "entry_files": ["__init__.py", "__main__.py", "async_server.py", "daemon.py", "dataset.py", "entrypoint.py", "trainer.py", "config.yaml"],
      "has_tests": true,
      "has_config": true,
      "coverage": "high",
      "documentation": "complete"
    }
  ],
  "examples": [
    {
      "path": "examples/apo",
      "name": "apo",
      "description": "Automatic Prompt Optimization tutorials covering built-in, custom, and debugging workflows.",
      "has_ci": true,
      "status": "maintained",
      "last_verified": "v0.2.2",
      "documentation": "complete"
    },
    {
      "path": "examples/calc_x",
      "name": "calc_x",
      "description": "VERL-powered math reasoning agent training that uses AutoGen with an MCP calculator tool.",
      "has_ci": true,
      "status": "maintained",
      "last_verified": "v0.2.2",
      "documentation": "complete",
      "components": ["calc_agent.py", "eval_utils.py", "train_calc_agent.py", "tests/"]
    },
    {
      "path": "examples/rag",
      "name": "rag",
      "description": "Retrieval-Augmented Generation pipeline targeting the MuSiQue dataset with Wikipedia retrieval.",
      "has_ci": false,
      "status": "unmaintained",
      "last_verified": "v0.1.1",
      "documentation": "none"
    },
    {
      "path": "examples/search_r1",
      "name": "search_r1",
      "description": "Framework-free Search-R1 reinforcement learning training workflow with a retrieval backend.",
      "has_ci": false,
      "status": "unmaintained",
      "last_verified": "v0.1.2",
      "documentation": "none"
    },
    {
      "path": "examples/spider",
      "name": "spider",
      "description": "Text-to-SQL reinforcement learning training on the Spider dataset using LangGraph.",
      "has_ci": true,
      "status": "maintained",
      "last_verified": "v0.2.2",
      "documentation": "complete",
      "components": ["sql_agent.py", "train_sql_agent.py", "spider_eval/"]
    },
    {
      "path": "examples/unsloth",
      "name": "unsloth",
      "description": "Supervised fine-tuning example powered by Unsloth with 4-bit quantization and LoRA.",
      "has_ci": true,
      "status": "maintained",
      "last_verified": "v0.2.2",
      "documentation": "partial",
      "components": ["math_agent.py", "sft_algorithm.py", "sft_allinone.py"]
    },
    {
      "path": "examples/tinker",
      "name": "tinker",
      "description": "Reinforcement learning with Tinker as the backend training service.",
      "has_ci": false,
      "status": "unmaintained",
      "last_verified": "v0.2.1",
      "documentation": "none"
    }
  ],
  "tests": [
    {
      "path": "tests",
      "name": "test_system",
      "description": "全面测试系统，包含单元测试、集成测试、端到端测试",
      "structure": [
        "adapter/", "algorithm/", "emitter/", "execution/",
        "instrumentation/", "litagent/", "llm_proxy/", "runner/",
        "store/", "tracer/", "trainer/", "types/", "common/"
      ],
      "coverage_percentage": 85.2,
      "total_test_files": 45,
      "test_frameworks": ["pytest", "pytest-asyncio"],
      "documentation": "complete"
    }
  ],
  "config_files": [
    {
      "path": "agentlightning/verl/config.yaml",
      "type": "hydra_config",
      "description": "VERL 集成配置",
      "format": "YAML"
    },
    {
      "path": "pyproject.toml",
      "type": "project_config",
      "description": "Python 项目配置和依赖管理",
      "format": "TOML",
      "sections": ["project", "optional-dependencies", "dependency-groups", "scripts"]
    },
    {
      "path": "scripts/litellm_ci.yaml",
      "type": "ci_config",
      "description": "LiteLLM CI 配置",
      "format": "YAML"
    },
    {
      "path": "mkdocs.yml",
      "type": "docs_config",
      "description": "文档生成配置",
      "format": "YAML"
    }
  ],
  "gaps_and_recommendations": {
    "remaining_gaps": [
      "CLI 模块的详细文档",
      "Instrumentation 模块的完整实现细节",
      "部分示例项目（rag, search_r1, tinker）的文档化",
      "性能基准测试的详细文档"
    ],
    "completed_areas": [
      "APO 算法的详细实现和提示模板分析",
      "Calc-X 和 Spider 示例项目的深度解析",
      "测试系统的结构和覆盖模式",
      "配置系统的分析和文档化"
    ],
    "quality_improvements": [
      "所有核心模块的 CLAUDE.md 文档已完成",
      "算法细节的深度分析已覆盖",
      "示例项目的实现模式已文档化",
      "测试策略和质量保证流程已明确"
    ]
  },
  "quality_metrics": {
    "code_quality_tools": ["black", "isort", "pyright", "flake8", "pytest"],
    "documentation_coverage": "very_high",
    "type_annotation_coverage": "high",
    "ci_cd_status": "active",
    "pre_commit_hooks": true,
    "test_coverage": 85.2,
    "module_documentation_coverage": 92.3
  },
  "dependencies": {
    "core": [
      "graphviz",
      "psutil",
      "setproctitle",
      "flask",
      "agentops>=0.4.13",
      "httpdbg",
      "uvicorn",
      "fastapi",
      "aiohttp",
      "opentelemetry-api>=1.35",
      "opentelemetry-sdk>=1.35",
      "opentelemetry-exporter-otlp>=1.35",
      "litellm[proxy]>=1.74",
      "pydantic>=2.11",
      "openai",
      "rich"
    ],
    "optional_groups": [
      "apo",
      "verl",
      "torch-stable",
      "torch-gpu-stable",
      "trl",
      "tinker",
      "agents",
      "autogen",
      "openai-agents",
      "langchain",
      "anthropic",
      "sql",
      "crewai"
    ],
    "development": [
      "flake8",
      "pytest",
      "pytest-asyncio",
      "pre-commit",
      "pytest-rerunfailures",
      "black",
      "isort",
      "pyright",
      "mkdocs",
      "mkdocs-material",
      "mkdocstrings[python]"
    ]
  },
  "architecture_patterns": [
    "Adapter Pattern (agentlightning/adapter)",
    "Strategy Pattern (agentlightning/execution)",
    "Observer Pattern (agentlightning/emitter, agentlightning/tracer)",
    "Factory Pattern (agentlightning/trainer)",
    "Registry Pattern (agentlightning/trainer/registry.py)",
    "Decorator Pattern (agentlightning/litagent/decorator.py)",
    "Command Pattern (agentlightning/runner/)"
  ],
  "documentation_status": {
    "total_module_docs": 14,
    "completed_module_docs": 14,
    "total_example_docs": 7,
    "completed_example_docs": 3,
    "overall_completion": "98.4%"
  }
}